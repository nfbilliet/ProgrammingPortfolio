

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>gqcml.torchgeom_interface package &mdash; GQCML 0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="gqcml.utils package" href="gqcml.utils.html" />
    <link rel="prev" title="gqcml.nn package" href="gqcml.nn.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> GQCML
          

          
            
            <img src="../_static/gqcg_logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="gqcml.data_generators.html">gqcml.data_generators package</a></li>
<li class="toctree-l1"><a class="reference internal" href="gqcml.data.html">gqcml.data package</a></li>
<li class="toctree-l1"><a class="reference internal" href="gqcml.datasets.html">gqcml.datasets package</a></li>
<li class="toctree-l1"><a class="reference internal" href="gqcml.nn.html">gqcml.nn package</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">gqcml.torchgeom_interface package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-gqcml.torchgeom_interface.auto_encoder">gqcml.torchgeom_interface.auto_encoder module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-gqcml.torchgeom_interface.blocks">gqcml.torchgeom_interface.blocks module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-gqcml.torchgeom_interface.datasets">gqcml.torchgeom_interface.datasets module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-gqcml.torchgeom_interface.models">gqcml.torchgeom_interface.models module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-gqcml.torchgeom_interface.models_3">gqcml.torchgeom_interface.models_3 module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-gqcml.torchgeom_interface.utils">gqcml.torchgeom_interface.utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-gqcml.torchgeom_interface">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="gqcml.utils.html">gqcml.utils package</a></li>
<li class="toctree-l1"><a class="reference internal" href="gqcml.meta.html">gqcml.meta package</a></li>
<li class="toctree-l1"><a class="reference internal" href="gqcml.analysis.html">gqcml.analysis package</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">GQCML</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>gqcml.torchgeom_interface package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/modules/gqcml.torchgeom_interface.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="gqcml-torchgeom-interface-package">
<h1>gqcml.torchgeom_interface package<a class="headerlink" href="#gqcml-torchgeom-interface-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-gqcml.torchgeom_interface.auto_encoder">
<span id="gqcml-torchgeom-interface-auto-encoder-module"></span><h2>gqcml.torchgeom_interface.auto_encoder module<a class="headerlink" href="#module-gqcml.torchgeom_interface.auto_encoder" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="gqcml.torchgeom_interface.auto_encoder.GraphAutoEncoder">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">gqcml.torchgeom_interface.auto_encoder.</span></code><code class="sig-name descname"><span class="pre">GraphAutoEncoder</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_aggr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_transformation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gqcml/torchgeom_interface/auto_encoder.html#GraphAutoEncoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gqcml.torchgeom_interface.auto_encoder.GraphAutoEncoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Graph auto-encoder that utilizes the neighbourhood aggregation class.
The encoder applies a series of unweighted graph convolutions  that construct
aggregated representation, residually added to the original or not.
In addition to this we als provide the option to store each aggregation step seperately and concatenate them at the end.</p>
<p>After aggregation the original feature vector is passed through an encoder dense network which contracts it to a specific dimension.
Following this contraction the encoded form is fed to the decoder dense network which will map it again to the original feature vector.</p>
<dl class="simple">
<dt>Attributes</dt><dd><dl class="field-list simple">
<dt class="field-odd">num_aggr (int)</dt>
<dd class="field-odd"><p>Number of neighbourhood aggregation that needs to be performed</p>
</dd>
<dt class="field-even">layer_config (list)</dt>
<dd class="field-even"><p>layer configuration for the encoder network. This configuration is reversed for the decoder dense network</p>
</dd>
<dt class="field-odd">act_fn (torch.nn)</dt>
<dd class="field-odd"><p>A torch module that serves as an activation for the encoder and decoder layers</p>
</dd>
<dt class="field-even">dropout (opt, bool)</dt>
<dd class="field-even"><p>A boolean that controls the employment of dropout between the layers</p>
</dd>
<dt class="field-odd">dropout_rate (opt, float)</dt>
<dd class="field-odd"><p>The dropout rate at which nodes are disable</p>
</dd>
<dt class="field-even">feature_transformation (opt, torch.nn.Module)</dt>
<dd class="field-even"><p>soon to be deprecated</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt id="gqcml.torchgeom_interface.auto_encoder.GraphAutoEncoder.decode">
<code class="sig-name descname"><span class="pre">decode</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">encoded_node_features</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gqcml/torchgeom_interface/auto_encoder.html#GraphAutoEncoder.decode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gqcml.torchgeom_interface.auto_encoder.GraphAutoEncoder.decode" title="Permalink to this definition">¶</a></dt>
<dd><p>Decoding of an encoded tensor
Forward phase of the encoder</p>
<dl class="simple">
<dt>Arguments</dt><dd><dl class="field-list simple">
<dt class="field-odd">encoded_node_features (torch.Tensor)</dt>
<dd class="field-odd"><p>A torch Tensor that represent the encoded feature vector which requires decoding</p>
</dd>
</dl>
</dd>
<dt>Returns</dt><dd><dl class="field-list simple">
<dt class="field-odd">decoded_features (torch.Tensor)</dt>
<dd class="field-odd"><p>The decoded form of the encoded features</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="gqcml.torchgeom_interface.auto_encoder.GraphAutoEncoder.encode">
<code class="sig-name descname"><span class="pre">encode</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gqcml/torchgeom_interface/auto_encoder.html#GraphAutoEncoder.encode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gqcml.torchgeom_interface.auto_encoder.GraphAutoEncoder.encode" title="Permalink to this definition">¶</a></dt>
<dd><p>Encoding of the initial feature vector</p>
<dl class="simple">
<dt>Arguments</dt><dd><dl class="field-list simple">
<dt class="field-odd">data (torch_geometric.data.Data)</dt>
<dd class="field-odd"><p>A data object that contains the node features, edge indices and edge weights</p>
</dd>
</dl>
</dd>
<dt>Returns</dt><dd><dl class="field-list simple">
<dt class="field-odd">encoded_features (torch.Tensor)</dt>
<dd class="field-odd"><p>The encoded representation of the initial feature vector</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="gqcml.torchgeom_interface.auto_encoder.GraphAutoEncoder.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gqcml/torchgeom_interface/auto_encoder.html#GraphAutoEncoder.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gqcml.torchgeom_interface.auto_encoder.GraphAutoEncoder.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward phase of the encoder</p>
<dl class="simple">
<dt>Arguments</dt><dd><dl class="field-list simple">
<dt class="field-odd">data (torch_geometric.data.Data)</dt>
<dd class="field-odd"><p>A data object that contains the node features, edge indices and edge weights</p>
</dd>
</dl>
</dd>
<dt>Returns</dt><dd><dl class="field-list simple">
<dt class="field-odd">initial features, decoded_features (torch.Tensor)</dt>
<dd class="field-odd"><p>The initial tensor obtained after aggregation of the neighbourhood information and the decoded form of this tensor</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="gqcml.torchgeom_interface.auto_encoder.Neighbourhood_Aggregator">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">gqcml.torchgeom_interface.auto_encoder.</span></code><code class="sig-name descname"><span class="pre">Neighbourhood_Aggregator</span></code><a class="reference internal" href="../_modules/gqcml/torchgeom_interface/auto_encoder.html#Neighbourhood_Aggregator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gqcml.torchgeom_interface.auto_encoder.Neighbourhood_Aggregator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch_geometric.nn.conv.message_passing.MessagePassing</span></code></p>
<p>A class that is used in the generation of a feature vector containing
raw node features that are aggregated. This function works in a similar
fashion to GCNConv but removes the use of any bias and weights.</p>
<dl class="py method">
<dt id="gqcml.torchgeom_interface.auto_encoder.Neighbourhood_Aggregator.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_index</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span> </span><span class="pre">torch_sparse.tensor.SparseTensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_weight</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">torch.Tensor</span><a class="reference internal" href="../_modules/gqcml/torchgeom_interface/auto_encoder.html#Neighbourhood_Aggregator.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gqcml.torchgeom_interface.auto_encoder.Neighbourhood_Aggregator.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="gqcml.torchgeom_interface.auto_encoder.Neighbourhood_Aggregator.message">
<code class="sig-name descname"><span class="pre">message</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_j</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_weight</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">torch.Tensor</span><a class="reference internal" href="../_modules/gqcml/torchgeom_interface/auto_encoder.html#Neighbourhood_Aggregator.message"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gqcml.torchgeom_interface.auto_encoder.Neighbourhood_Aggregator.message" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs messages from node <span class="math notranslate nohighlight">\(j\)</span> to node <span class="math notranslate nohighlight">\(i\)</span>
in analogy to <span class="math notranslate nohighlight">\(\phi_{\mathbf{\Theta}}\)</span> for each edge in
<code class="xref py py-obj docutils literal notranslate"><span class="pre">edge_index</span></code>.
This function can take any argument as input which was initially
passed to <code class="xref py py-meth docutils literal notranslate"><span class="pre">propagate()</span></code>.
Furthermore, tensors passed to <code class="xref py py-meth docutils literal notranslate"><span class="pre">propagate()</span></code> can be mapped to the
respective nodes <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span> by appending <code class="xref py py-obj docutils literal notranslate"><span class="pre">_i</span></code> or
<code class="xref py py-obj docutils literal notranslate"><span class="pre">_j</span></code> to the variable name, <em>.e.g.</em> <code class="xref py py-obj docutils literal notranslate"><span class="pre">x_i</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">x_j</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="gqcml.torchgeom_interface.auto_encoder.Neighbourhood_Aggregator.message_and_aggregate">
<code class="sig-name descname"><span class="pre">message_and_aggregate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adj_t</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch_sparse.tensor.SparseTensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">torch.Tensor</span><a class="reference internal" href="../_modules/gqcml/torchgeom_interface/auto_encoder.html#Neighbourhood_Aggregator.message_and_aggregate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gqcml.torchgeom_interface.auto_encoder.Neighbourhood_Aggregator.message_and_aggregate" title="Permalink to this definition">¶</a></dt>
<dd><p>Fuses computations of <a class="reference internal" href="#gqcml.torchgeom_interface.auto_encoder.Neighbourhood_Aggregator.message" title="gqcml.torchgeom_interface.auto_encoder.Neighbourhood_Aggregator.message"><code class="xref py py-func docutils literal notranslate"><span class="pre">message()</span></code></a> and <code class="xref py py-func docutils literal notranslate"><span class="pre">aggregate()</span></code> into a
single function.
If applicable, this saves both time and memory since messages do not
explicitly need to be materialized.
This function will only gets called in case it is implemented and
propagation takes place based on a <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch_sparse.SparseTensor</span></code>.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="gqcml.torchgeom_interface.auto_encoder.sum_similarity_loss">
<code class="sig-prename descclassname"><span class="pre">gqcml.torchgeom_interface.auto_encoder.</span></code><code class="sig-name descname"><span class="pre">sum_similarity_loss</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inp_tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoded_tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gqcml/torchgeom_interface/auto_encoder.html#sum_similarity_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gqcml.torchgeom_interface.auto_encoder.sum_similarity_loss" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="gqcml.torchgeom_interface.auto_encoder.train_model">
<code class="sig-prename descclassname"><span class="pre">gqcml.torchgeom_interface.auto_encoder.</span></code><code class="sig-name descname"><span class="pre">train_model</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmb_epochs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_logger</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheduler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gqcml/torchgeom_interface/auto_encoder.html#train_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gqcml.torchgeom_interface.auto_encoder.train_model" title="Permalink to this definition">¶</a></dt>
<dd><p>train model</p>
<p>A function that trains a given neural network</p>
<dl class="simple">
<dt>Arguments</dt><dd><dl class="field-list simple">
<dt class="field-odd">device (str)</dt>
<dd class="field-odd"><p>The device to which the model and tensors are moved during training.</p>
</dd>
<dt class="field-even">model (torch.Module)</dt>
<dd class="field-even"><p>The neural network that needs to be trained. This is aa torch.nn.Module class that
has a forward function</p>
</dd>
<dt class="field-odd">nmb_epochs (int)</dt>
<dd class="field-odd"><p>The number of epochs that the model needs to be trained</p>
</dd>
<dt class="field-even">train_loader (torch.DataLoader)</dt>
<dd class="field-even"><p>The dataloader that contains the training dataset and generates batches</p>
</dd>
<dt class="field-odd">val_loader (torch.DataLoader)</dt>
<dd class="field-odd"><p>The dataloader that contains the validation dataset and generates batches</p>
</dd>
<dt class="field-even">loss_fn (torch.nn)</dt>
<dd class="field-even"><p>The loss function that is used during the optimization of the neural network</p>
</dd>
<dt class="field-odd">optimizer (torch.optim)</dt>
<dd class="field-odd"><p>The optimizer that is used during the training of the model</p>
</dd>
<dt class="field-even">model_logger (gqcml.utils.train)</dt>
<dd class="field-even"><p>The model logger class that registers the training progress and saves the best model</p>
</dd>
<dt class="field-odd">(optional) scheduler (torch.optim.lr_scheduler)</dt>
<dd class="field-odd"><p>A scheduler for decreasing the learning rate</p>
</dd>
</dl>
</dd>
<dt>Returns</dt><dd><dl class="field-list simple">
<dt class="field-odd">optimized_model (torch.nn.Module)</dt>
<dd class="field-odd"><p>The optimized model after the specified options</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-gqcml.torchgeom_interface.blocks">
<span id="gqcml-torchgeom-interface-blocks-module"></span><h2>gqcml.torchgeom_interface.blocks module<a class="headerlink" href="#module-gqcml.torchgeom_interface.blocks" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="gqcml.torchgeom_interface.blocks.GCNConv_block">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">gqcml.torchgeom_interface.blocks.</span></code><code class="sig-name descname"><span class="pre">GCNConv_block</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inp_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_layers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_self_loops</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gqcml/torchgeom_interface/blocks.html#GCNConv_block"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gqcml.torchgeom_interface.blocks.GCNConv_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>A network component that construct a sequence of GCNConv layers from torch_geometric
These layers all have the same structure, with expection of the first layer.
Attributes</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">inp_dim (int)</dt>
<dd class="field-odd"><p>The dimension of the node feature before application of the GCNConv layers</p>
</dd>
<dt class="field-even">hidden_channels (int)</dt>
<dd class="field-even"><p>The dimension to which the GCNConv layers map the node features</p>
</dd>
<dt class="field-odd">num_layers (int)</dt>
<dd class="field-odd"><p>The number of GCNConv layers</p>
</dd>
<dt class="field-even">act_fn (torch.nn)</dt>
<dd class="field-even"><p>The activation function used after each layer</p>
</dd>
<dt class="field-odd">add_self_loops (opt, bool)</dt>
<dd class="field-odd"><p>The add_self_loops option of the GCNConv layer, this value is set to False by default</p>
</dd>
<dt class="field-even">normalize (opt, bool)</dt>
<dd class="field-even"><p>The normalize option of the GCNConv layer, this value is set to False by default</p>
</dd>
<dt class="field-odd">bias (opt, bool)</dt>
<dd class="field-odd"><p>The option to include a bias term in the GCNConv layer, this value is set to True by default</p>
</dd>
<dt class="field-even">residual (opt, bool)</dt>
<dd class="field-even"><p>The option to add a residual connection after application of the activation function.</p>
</dd>
</dl>
</div></blockquote>
<dl class="py method">
<dt id="gqcml.torchgeom_interface.blocks.GCNConv_block.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_attr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gqcml/torchgeom_interface/blocks.html#GCNConv_block.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gqcml.torchgeom_interface.blocks.GCNConv_block.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="gqcml.torchgeom_interface.blocks.GCNConv_block.meta">
<code class="sig-name descname"><span class="pre">meta</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gqcml/torchgeom_interface/blocks.html#GCNConv_block.meta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gqcml.torchgeom_interface.blocks.GCNConv_block.meta" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="gqcml.torchgeom_interface.blocks.GraphConv_block">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">gqcml.torchgeom_interface.blocks.</span></code><code class="sig-name descname"><span class="pre">GraphConv_block</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inp_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_layers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'add'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gqcml/torchgeom_interface/blocks.html#GraphConv_block"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gqcml.torchgeom_interface.blocks.GraphConv_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>A network component that construct a sequence of GCNConv layers from torch_geometric
These layers all have the same structure, with expection of the first layer.
Attributes</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">inp_dim (int)</dt>
<dd class="field-odd"><p>The dimension of the node feature before application of the GCNConv layers</p>
</dd>
<dt class="field-even">hidden_channels (int)</dt>
<dd class="field-even"><p>The dimension to which the GCNConv layers map the node features</p>
</dd>
<dt class="field-odd">num_layers (int)</dt>
<dd class="field-odd"><p>The number of GCNConv layers</p>
</dd>
<dt class="field-even">act_fn (torch.nn)</dt>
<dd class="field-even"><p>The activation function used after each layer</p>
</dd>
<dt class="field-odd">aggr (opt, str)</dt>
<dd class="field-odd"><p>String that determines how the message should be added, this value is by default add</p>
</dd>
<dt class="field-even">bias (opt, bool)</dt>
<dd class="field-even"><p>The option to include a bias term in the GCNConv layer, this value is set to True by default</p>
</dd>
<dt class="field-odd">residual (opt, bool)</dt>
<dd class="field-odd"><p>The option to add a residual connection after application of the activation function.</p>
</dd>
</dl>
</div></blockquote>
<dl class="py method">
<dt id="gqcml.torchgeom_interface.blocks.GraphConv_block.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_attr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gqcml/torchgeom_interface/blocks.html#GraphConv_block.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gqcml.torchgeom_interface.blocks.GraphConv_block.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="gqcml.torchgeom_interface.blocks.GraphConv_block.meta">
<code class="sig-name descname"><span class="pre">meta</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gqcml/torchgeom_interface/blocks.html#GraphConv_block.meta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gqcml.torchgeom_interface.blocks.GraphConv_block.meta" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-gqcml.torchgeom_interface.datasets">
<span id="gqcml-torchgeom-interface-datasets-module"></span><h2>gqcml.torchgeom_interface.datasets module<a class="headerlink" href="#module-gqcml.torchgeom_interface.datasets" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="gqcml.torchgeom_interface.datasets.TriuDataset">
<code class="sig-prename descclassname"><span class="pre">gqcml.torchgeom_interface.datasets.</span></code><code class="sig-name descname"><span class="pre">TriuDataset</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gqcml/torchgeom_interface/datasets.html#TriuDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gqcml.torchgeom_interface.datasets.TriuDataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to convert a set of trius to a set of datapoints</p>
</dd></dl>

<dl class="py function">
<dt id="gqcml.torchgeom_interface.datasets.graph_to_Data">
<code class="sig-prename descclassname"><span class="pre">gqcml.torchgeom_interface.datasets.</span></code><code class="sig-name descname"><span class="pre">graph_to_Data</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">am</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gqcml/torchgeom_interface/datasets.html#graph_to_Data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gqcml.torchgeom_interface.datasets.graph_to_Data" title="Permalink to this definition">¶</a></dt>
<dd><p>A function that converts a set of tensor to a Data object from torch_geometric</p>
<dl class="simple">
<dt>Arguments</dt><dd><dl class="field-list simple">
<dt class="field-odd">nf (torch.Tensor)</dt>
<dd class="field-odd"><p>A tensor containing the node features associated with the graphs</p>
</dd>
<dt class="field-even">am (torch.Tensor)</dt>
<dd class="field-even"><p>A tensor containing the adjacency matrices describing the graphs</p>
</dd>
<dt class="field-odd">output (torch.Tensor)</dt>
<dd class="field-odd"><p>The graph property tensor associated with the graphs</p>
</dd>
</dl>
</dd>
<dt>Returns</dt><dd><dl class="field-list simple">
<dt class="field-odd">dp (torch_geometric.data.Data)</dt>
<dd class="field-odd"><p>A data object where the node features are stored in the x attribute of Data.
The adjacency matrix is split into the indices and weights and are stored in their respective attributes</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-gqcml.torchgeom_interface.models">
<span id="gqcml-torchgeom-interface-models-module"></span><h2>gqcml.torchgeom_interface.models module<a class="headerlink" href="#module-gqcml.torchgeom_interface.models" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="gqcml.torchgeom_interface.models.Graph_Convolution_attentionpool_model">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">gqcml.torchgeom_interface.models.</span></code><code class="sig-name descname"><span class="pre">Graph_Convolution_attentionpool_model</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">emb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_block</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prop_dnn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gate_nn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gqcml/torchgeom_interface/models.html#Graph_Convolution_attentionpool_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gqcml.torchgeom_interface.models.Graph_Convolution_attentionpool_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>A general graph convolution model constructor that utilizes pooling of the node features to generate a general graph feature that is
used to map to a graph property. This pooling mechanism utilizes the attention mechanism that learns to predict node importance to the graph feature of interest.</p>
<dl class="simple">
<dt>Attributes</dt><dd><dl class="field-list simple">
<dt class="field-odd">emb (torch.nn.Module)</dt>
<dd class="field-odd"><p>A sequential object that maps the initial node features to the starting embedded node features.</p>
</dd>
<dt class="field-even">conv (torch.nn.Module)</dt>
<dd class="field-even"><p>A sequential object that contains the graph convolutions</p>
</dd>
<dt class="field-odd">prop_ddn (torch.nn.Module)</dt>
<dd class="field-odd"><p>A sequential object that maps the aggregated node features obtained from the conv block to the graph property</p>
</dd>
<dt class="field-even">gate_nn (torch.nn.Module)</dt>
<dd class="field-even"><p><a class="reference external" href="https://pytorch-geometric.readthedocs.io/en/latest/modules/nn.html#torch_geometric.nn.glob.GlobalAttention">https://pytorch-geometric.readthedocs.io/en/latest/modules/nn.html#torch_geometric.nn.glob.GlobalAttention</a></p>
</dd>
<dt class="field-odd">nn (torch.nn.Module)</dt>
<dd class="field-odd"><p><a class="reference external" href="https://pytorch-geometric.readthedocs.io/en/latest/modules/nn.html#torch_geometric.nn.glob.GlobalAttention">https://pytorch-geometric.readthedocs.io/en/latest/modules/nn.html#torch_geometric.nn.glob.GlobalAttention</a></p>
</dd>
<dt class="field-even">max_feature (opt, bool)</dt>
<dd class="field-even"><p>A boolean that controls whether to extend the average pooled features with a max pooled set of features.
This additional graph pooled features will then be concatenated to the average pooled feature</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt id="gqcml.torchgeom_interface.models.Graph_Convolution_attentionpool_model.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gqcml/torchgeom_interface/models.html#Graph_Convolution_attentionpool_model.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gqcml.torchgeom_interface.models.Graph_Convolution_attentionpool_model.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="gqcml.torchgeom_interface.models.Graph_Convolution_attentionpool_model.meta">
<code class="sig-name descname"><span class="pre">meta</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gqcml/torchgeom_interface/models.html#Graph_Convolution_attentionpool_model.meta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gqcml.torchgeom_interface.models.Graph_Convolution_attentionpool_model.meta" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="gqcml.torchgeom_interface.models.Graph_Convolution_avgpool_model">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">gqcml.torchgeom_interface.models.</span></code><code class="sig-name descname"><span class="pre">Graph_Convolution_avgpool_model</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">emb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_block</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prop_dnn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gqcml/torchgeom_interface/models.html#Graph_Convolution_avgpool_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gqcml.torchgeom_interface.models.Graph_Convolution_avgpool_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>A general graph convolution model constructor that utilizes pooling of the node features to generate a general graph feature that is
used to map to a graph property.</p>
<dl class="simple">
<dt>Attributes</dt><dd><dl class="field-list simple">
<dt class="field-odd">emb (torch.nn.Module)</dt>
<dd class="field-odd"><p>A sequential object that maps the initial node features to the starting embedded node features.</p>
</dd>
<dt class="field-even">conv (torch.nn.Module)</dt>
<dd class="field-even"><p>A sequential object that contains the graph convolutions</p>
</dd>
<dt class="field-odd">prop_ddn (torch.nn.Module)</dt>
<dd class="field-odd"><p>A sequential object that maps the aggregated node features obtained from the conv block to the graph property</p>
</dd>
<dt class="field-even">max_feature (opt, bool)</dt>
<dd class="field-even"><p>A boolean that controls whether to extend the average pooled features with a max pooled set of features.
This additional graph pooled features will then be concatenated to the average pooled feature</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt id="gqcml.torchgeom_interface.models.Graph_Convolution_avgpool_model.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gqcml/torchgeom_interface/models.html#Graph_Convolution_avgpool_model.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gqcml.torchgeom_interface.models.Graph_Convolution_avgpool_model.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="gqcml.torchgeom_interface.models.Graph_Convolution_avgpool_model.meta">
<code class="sig-name descname"><span class="pre">meta</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gqcml/torchgeom_interface/models.html#Graph_Convolution_avgpool_model.meta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gqcml.torchgeom_interface.models.Graph_Convolution_avgpool_model.meta" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="gqcml.torchgeom_interface.models.Graph_Convolution_model">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">gqcml.torchgeom_interface.models.</span></code><code class="sig-name descname"><span class="pre">Graph_Convolution_model</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">emb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_block</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prop_dnn</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gqcml/torchgeom_interface/models.html#Graph_Convolution_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gqcml.torchgeom_interface.models.Graph_Convolution_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>A general graph convolution model constructor.</p>
<dl class="simple">
<dt>Attributes</dt><dd><dl class="field-list simple">
<dt class="field-odd">emb (torch.nn.Module)</dt>
<dd class="field-odd"><p>A sequential object that maps the initial node features to the starting embedded node features.</p>
</dd>
<dt class="field-even">conv (torch.nn.Module)</dt>
<dd class="field-even"><p>A sequential object that contains the graph convolutions</p>
</dd>
<dt class="field-odd">prop_ddn (torch.nn.Module)</dt>
<dd class="field-odd"><p>A sequential object that maps the aggregated node features obtained from the conv block to the graph property</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt id="gqcml.torchgeom_interface.models.Graph_Convolution_model.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gqcml/torchgeom_interface/models.html#Graph_Convolution_model.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gqcml.torchgeom_interface.models.Graph_Convolution_model.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="gqcml.torchgeom_interface.models.Graph_Convolution_model.meta">
<code class="sig-name descname"><span class="pre">meta</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gqcml/torchgeom_interface/models.html#Graph_Convolution_model.meta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gqcml.torchgeom_interface.models.Graph_Convolution_model.meta" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-gqcml.torchgeom_interface.models_3">
<span id="gqcml-torchgeom-interface-models-3-module"></span><h2>gqcml.torchgeom_interface.models_3 module<a class="headerlink" href="#module-gqcml.torchgeom_interface.models_3" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="gqcml.torchgeom_interface.models_3.GCNConv">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">gqcml.torchgeom_interface.models_3.</span></code><code class="sig-name descname"><span class="pre">GCNConv</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node_embedding_nn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gc_layers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation_function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_prop_nn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_self_loops</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gqcml/torchgeom_interface/models_3.html#GCNConv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gqcml.torchgeom_interface.models_3.GCNConv" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>GCNConv model</p>
<p>A standard graph convolutional network using the torch geomtric interface</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_sites</strong> – number of sites/atoms in the Hückel model</p></li>
<li><p><strong>node_embedding_nn</strong> (<em>torch.nn.Module</em>) – A torch.nn.Module that processes the initial node features. This torch module
takes a tensor with dimensions (B x N x f)  and should return a tensor with
dimensions (B x N x F) where B is the batch size, N is the number of nodes in
the graphs, f is the initial number of node features and F is the number of node features
associated with each node in the graph. F should be equal to the node_input_dim
parameter of the GraphConv layers.</p></li>
<li><p><strong>gcn_configs</strong> (<em>list</em>) – A list containing the dimensions of the consecutive layers of the embedding section of the network
The first value of this list corresponds to the dimensions of the node feature vector and the last
value corresponds to the first node feature dimension of the graph convolutions section.</p></li>
<li><p><strong>activation_function</strong> (<em>torch.nn</em>) – The activation function that will be used in after each layer in the embedding, graph convolution
and property prediction phase of the network</p></li>
<li><p><strong>node_prop_nn</strong> (<em>torch.nn.Module</em>) – A torch.nn.Module that processes the transformed node features after the application
of the graph convolution operators. The network takes the node features with dimension
(B x N x F) where B is the batch size, N is the number of nodes in the graph and F
the number of features associated with each node in the graphs. The output of the network
is a tensor that has the dimensions (B x N x 1) where the resulting features are
mapped to a single node property.</p></li>
<li><p><strong>normalize</strong> (<em>optional</em><em>, </em><em>boolean</em>) – Option to enable the use of the normalized form of the graph convolution</p></li>
<li><p><strong>bias</strong> (<em>optional</em><em>, </em><em>boolean</em>) – Option to add a bias to the layers</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="gqcml.torchgeom_interface.models_3.GCNConv.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gqcml/torchgeom_interface/models_3.html#GCNConv.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gqcml.torchgeom_interface.models_3.GCNConv.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward</p>
<p>The function to compute the model output.</p>
<p>Parameters</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">param data (torch_geometric.data.Batch)</dt>
<dd class="field-odd"><p>A Batch object from torch geometric obtained from the loader
which contains x, edge_index, edge_attr and batch</p>
</dd>
<dt class="field-even">return graph property (torch.tensor)</dt>
<dd class="field-even"><p>A 2D tensor containing the output values associated with the input graphs</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="gqcml.torchgeom_interface.models_3.GCNConv.meta">
<code class="sig-name descname"><span class="pre">meta</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gqcml/torchgeom_interface/models_3.html#GCNConv.meta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gqcml.torchgeom_interface.models_3.GCNConv.meta" title="Permalink to this definition">¶</a></dt>
<dd><p>Meta</p>
<p>Returns a dictionary that contains all the network parameters sorted according 3
blocks (embedding, gc and property).</p>
</dd></dl>

<dl class="py method">
<dt id="gqcml.torchgeom_interface.models_3.GCNConv.node_properties">
<code class="sig-name descname"><span class="pre">node_properties</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gqcml/torchgeom_interface/models_3.html#GCNConv.node_properties"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gqcml.torchgeom_interface.models_3.GCNConv.node_properties" title="Permalink to this definition">¶</a></dt>
<dd><p>Node properties</p>
<p>Returns the properties of the nodes, i.e. the output of the layer before summing to obtain the
graph property</p>
<p>Parameters</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">param data (torch_geometric.data.Batch)</dt>
<dd class="field-odd"><p>A Batch object from torch geometric obtained from the loader
which contains x, edge_index, edge_attr and batch</p>
</dd>
<dt class="field-even">return node properties (torch.tensor)</dt>
<dd class="field-even"><p>A 2D tensor containing the output values associated with the
nodes of the input graphs</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="gqcml.torchgeom_interface.models_3.GatedGraphConv">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">gqcml.torchgeom_interface.models_3.</span></code><code class="sig-name descname"><span class="pre">GatedGraphConv</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node_embedding_nn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmb_layers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_prop_nn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gqcml/torchgeom_interface/models_3.html#GatedGraphConv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gqcml.torchgeom_interface.models_3.GatedGraphConv" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Gated Graph Conv model</p>
<p>A standard graph convolutional network using the torch geomtric interface</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_sites</strong> – number of sites/atoms in the Hückel model</p></li>
<li><p><strong>node_embedding_nn</strong> (<em>torch.nn.Module</em>) – A torch.nn.Module that processes the initial node features. This torch module
takes a tensor with dimensions (B x N x f)  and should return a tensor with
dimensions (B x N x F) where B is the batch size, N is the number of nodes in
the graphs, f is the initial number of node features and F is the number of node features
associated with each node in the graph. F should be equal to the node_input_dim
parameter of the GraphConv layers.</p></li>
<li><p><strong>gcn_configs</strong> (<em>list</em>) – A list containing the dimensions of the consecutive layers of the embedding section of the network
The first value of this list corresponds to the dimensions of the node feature vector and the last
value corresponds to the first node feature dimension of the graph convolutions section.</p></li>
<li><p><strong>activation_function</strong> (<em>torch.nn</em>) – The activation function that will be used in after each layer in the embedding, graph convolution
and property prediction phase of the network</p></li>
<li><p><strong>node_prop_nn</strong> (<em>torch.nn.Module</em>) – A torch.nn.Module that processes the transformed node features after the application
of the graph convolution operators. The network takes the node features with dimension
(B x N x F) where B is the batch size, N is the number of nodes in the graph and F
the number of features associated with each node in the graphs. The output of the network
is a tensor that has the dimensions (B x N x 1) where the resulting features are
mapped to a single node property.</p></li>
<li><p><strong>normalize</strong> (<em>optional</em><em>, </em><em>boolean</em>) – Option to enable the use of the normalized form of the graph convolution</p></li>
<li><p><strong>bias</strong> (<em>optional</em><em>, </em><em>boolean</em>) – Option to add a bias to the layers</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="gqcml.torchgeom_interface.models_3.GatedGraphConv.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gqcml/torchgeom_interface/models_3.html#GatedGraphConv.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gqcml.torchgeom_interface.models_3.GatedGraphConv.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward</p>
<p>The function to compute the model output.</p>
<p>Parameters</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">param data (torch_geometric.data.Batch)</dt>
<dd class="field-odd"><p>A Batch object from torch geometric obtained from the loader
which contains x, edge_index, edge_attr and batch</p>
</dd>
<dt class="field-even">return graph property (torch.tensor)</dt>
<dd class="field-even"><p>A 2D tensor containing the output values associated with the input graphs</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="gqcml.torchgeom_interface.models_3.GatedGraphConv.meta">
<code class="sig-name descname"><span class="pre">meta</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gqcml/torchgeom_interface/models_3.html#GatedGraphConv.meta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gqcml.torchgeom_interface.models_3.GatedGraphConv.meta" title="Permalink to this definition">¶</a></dt>
<dd><p>Meta</p>
<p>Returns a dictionary that contains all the network parameters sorted according 3
blocks (embedding, gc and property).</p>
</dd></dl>

<dl class="py method">
<dt id="gqcml.torchgeom_interface.models_3.GatedGraphConv.node_properties">
<code class="sig-name descname"><span class="pre">node_properties</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gqcml/torchgeom_interface/models_3.html#GatedGraphConv.node_properties"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gqcml.torchgeom_interface.models_3.GatedGraphConv.node_properties" title="Permalink to this definition">¶</a></dt>
<dd><p>Node properties</p>
<p>Returns the properties of the nodes, i.e. the output of the layer before summing to obtain the
graph property</p>
<p>Parameters</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">param data (torch_geometric.data.Batch)</dt>
<dd class="field-odd"><p>A Batch object from torch geometric obtained from the loader
which contains x, edge_index, edge_attr and batch</p>
</dd>
<dt class="field-even">return node properties (torch.tensor)</dt>
<dd class="field-even"><p>A 2D tensor containing the output values associated with the
nodes of the input graphs</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-gqcml.torchgeom_interface.utils">
<span id="gqcml-torchgeom-interface-utils-module"></span><h2>gqcml.torchgeom_interface.utils module<a class="headerlink" href="#module-gqcml.torchgeom_interface.utils" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="gqcml.torchgeom_interface.utils.evaluate_model">
<code class="sig-prename descclassname"><span class="pre">gqcml.torchgeom_interface.utils.</span></code><code class="sig-name descname"><span class="pre">evaluate_model</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modelname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_descr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'_val.pth'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gqcml/torchgeom_interface/utils.html#evaluate_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gqcml.torchgeom_interface.utils.evaluate_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the optimal model on the test data</p>
<dl class="simple">
<dt>Arguments</dt><dd><dl class="field-list simple">
<dt class="field-odd">device (str)</dt>
<dd class="field-odd"><p>The device to which the model and tensors are moved during training.</p>
</dd>
<dt class="field-even">model_path (str)</dt>
<dd class="field-even"><p></p></dd>
<dt class="field-odd">error_path (str)</dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">modelname (str)</dt>
<dd class="field-even"><p></p></dd>
<dt class="field-odd">model (torch.nn.Module)</dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">test_loader (torch_geometric.data.DataLoader)</dt>
<dd class="field-even"><p></p></dd>
</dl>
</dd>
<dt>Returns</dt><dd><dl class="field-list simple">
<dt class="field-odd">model (torch.nn.Module)</dt>
<dd class="field-odd"><p>The optimized model</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="gqcml.torchgeom_interface.utils.train_model">
<code class="sig-prename descclassname"><span class="pre">gqcml.torchgeom_interface.utils.</span></code><code class="sig-name descname"><span class="pre">train_model</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmb_epochs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_logger</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheduler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gqcml/torchgeom_interface/utils.html#train_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gqcml.torchgeom_interface.utils.train_model" title="Permalink to this definition">¶</a></dt>
<dd><p>A function that trains a given neural network</p>
<dl class="simple">
<dt>Arguments</dt><dd><dl class="field-list simple">
<dt class="field-odd">device (str)</dt>
<dd class="field-odd"><p>The device to which the model and tensors are moved during training.</p>
</dd>
<dt class="field-even">model (torch.Module)</dt>
<dd class="field-even"><p>The neural network that needs to be trained. This is aa torch.nn.Module class that
has a forward function</p>
</dd>
<dt class="field-odd">nmb_epochs (int)</dt>
<dd class="field-odd"><p>The number of epochs that the model needs to be trained</p>
</dd>
<dt class="field-even">train_loader (torch.DataLoader)</dt>
<dd class="field-even"><p>The dataloader that contains the training dataset and generates batches</p>
</dd>
<dt class="field-odd">val_loader (torch.DataLoader)</dt>
<dd class="field-odd"><p>The dataloader that contains the validation dataset and generates batches</p>
</dd>
<dt class="field-even">loss_fn (torch.nn)</dt>
<dd class="field-even"><p>The loss function that is used during the optimization of the neural network</p>
</dd>
<dt class="field-odd">optimizer (torch.optim)</dt>
<dd class="field-odd"><p>The optimizer that is used during the training of the model</p>
</dd>
<dt class="field-even">model_logger (gqcml.utils.train)</dt>
<dd class="field-even"><p>The model logger class that registers the training progress and saves the best model</p>
</dd>
<dt class="field-odd">scheduler (opt, torch.optim.lr_scheduler)</dt>
<dd class="field-odd"><p>A scheduler for decreasing the learning rate</p>
</dd>
</dl>
</dd>
<dt>Returns</dt><dd><dl class="field-list simple">
<dt class="field-odd">model (torch.nn.Module)</dt>
<dd class="field-odd"><p>The optimized model</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-gqcml.torchgeom_interface">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-gqcml.torchgeom_interface" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="gqcml.utils.html" class="btn btn-neutral float-right" title="gqcml.utils package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="gqcml.nn.html" class="btn btn-neutral float-left" title="gqcml.nn package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, Niels Billiet

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>